<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página Inicial - Empresa</title>
    <script>
        const BASE_URL = "http://127.0.0.1:8080/api/empresas";

        async function uploadLogo() {
            const logoUrl = document.getElementById("logoUrl").value;
            const idEmpresa = localStorage.getItem("empresaId");

            if (!idEmpresa || !logoUrl) {
                alert("Preencha todos os campos antes de enviar.");
                return;
            }
        
            try {
                const response = await fetch("http://127.0.0.1:8080/api/empresas/upload-logo", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ idEmpresa, logoUrl }),
                });
            
                if (response.ok) {
                    alert("Logo atualizada com sucesso!");
                } else {
                    const errorResponse = await response.json();
                    alert(`Erro ao atualizar logo: ${errorResponse.error || "Erro desconhecido."}`);
                }
            } catch (error) {
                alert("Erro ao atualizar logo. Tente novamente.");
            }
        }

        


        async function carregarEmpresa() {
            const idEmpresa = localStorage.getItem("empresaId");

            if (!idEmpresa) {
                alert("ID da empresa não encontrado. Faça login novamente.");
                window.location.href = "login-empresa.html";
                return;
            }

            try {
                const response = await fetch(`${BASE_URL}/${idEmpresa}`);
                if (!response.ok) throw new Error(await response.text());

                const empresa = await response.json();
                document.getElementById("empresaNome").innerText = empresa.nomeCorporativo;

                if (empresa.logoUrl) {
                    document.getElementById("empresaLogo").src = empresa.logoUrl;
                    document.getElementById("empresaLogo").alt = "Logo da Empresa";
                } else {
                    document.getElementById("empresaLogo").src = "";
                    document.getElementById("empresaLogo").alt = "Logo não disponível";
                }
            } catch (error) {
                alert(`Erro ao carregar empresa: ${error.message}`);
            }
        }

        window.onload = carregarEmpresa;
    </script>
</head>
<body>
    <h1>Bem-vindo, <span id="empresaNome"></span></h1>
    <img id="empresaLogo" src="" alt="Logo da Empresa" width="150" />
    <br />
    <input type="text" id="logoUrl" placeholder="URL da Logo" />
    <button onclick="uploadLogo()">Atualizar Logo</button>
</body>
</html>
